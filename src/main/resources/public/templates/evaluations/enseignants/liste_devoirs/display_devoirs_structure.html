<!--
  ~ Copyright (c) Région Hauts-de-France, Département 77, CGI, 2016.
  ~
  ~ This file is part of OPEN ENT NG. OPEN ENT NG is a versatile ENT Project based on the JVM and ENT Core Project.
  ~
  ~ This program is free software; you can redistribute it and/or modify
  ~ it under the terms of the GNU Affero General Public License as
  ~ published by the Free Software Foundation (version 3 of the License).
  ~ For the sake of explanation, any module that communicate over native
  ~ Web protocols, such as HTTP, with OPEN ENT NG is outside the scope of this
  ~ license and could be license under its own terms. This is merely considered
  ~ normal use of OPEN ENT NG, and does not fall under the heading of "covered work".
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  ~
  -->

<div class="row">
    <nav class="twelve cell marginLeftFive nav-devoirs">
        <div class="cell switch-view-buttons">
            <i class="show-list" ng-class="{ selected: template.contains('evaluations', '../templates/evaluations/enseignants/liste_devoirs/list_view') }"
               ng-click="template.open('evaluations', '../templates/evaluations/enseignants/liste_devoirs/list_view')"></i>
            <i class="show-icons" ng-class="{ selected: template.contains('evaluations', '../templates/evaluations/enseignants/liste_devoirs/icon_view') }"
               ng-click="template.open('evaluations', '../templates/evaluations/enseignants/liste_devoirs/icon_view')"></i>
        </div>
        <button class="marginFive" ng-click="goTo('/devoir/create');"><i18n>evaluations.test.new</i18n></button>
        <div class="microbox-wrapper zero">
            <div class="microbox-content">
                <i class="close-2x"></i>
                <div class="microbox-material"></div>
                <button class="microbox-close"></button>
            </div>
        </div>
    </nav>
    <div class="twelve cell list-devoirs">
        <microbox title="evaluations.criteres.titre.bouton.ouvrir" close="evaluations.criteres.titre.bouton.fermer">
            <div  class="two cell twelve-mobile">
                <div class="criterion card" >
                    <div  class="header">
                        <h2><i18n>viescolaire.utils.criterion</i18n></h2>
                    </div>

                    <section>
                        <label class="select">
                            <select ng-model="search.classe" ng-change="getReleve();" ng-options="classe.name for classe in classes.all">
                                <option value="" class="header-opt">[[translate('viescolaire.utils.class')]]</option>
                            </select>
                        </label>
                    </section>

                    <section >
                        <label class="select">
                            <select ng-model="search.matiere" ng-change="getReleve()"
                                    ng-options="matiere.name for matiere in matieres.all | unique:'name'">
                                <option value="" class="header-opt">[[translate('viescolaire.utils.subject')]]</option>
                            </select>
                        </label>
                    </section>

                    <section>
                        <label class="select" ng-hide="selected.matiere.sousMatieres.all.length === 0 || search.matiere === '*' || selected.matiere === undefined">
                            <select ng-model="search.sousmatiere" ng-options="sousmatiere.libelle for sousmatiere in search.sousmatieres.all">
                                <option class="header-opt" value="">[[translate('viescolaire.utils.undersubject')]]</option>
                            </select>
                        </label>
                    </section>

                    <section>
                        <label class="select">
                            <select ng-model="search.type" ng-options="type.nom for type in types.all">
                                <option class="header-opt" value="">[[translate('viescolaire.utils.type')]]</option>
                            </select>
                        </label>
                    </section>

                    <section>
                        <label class="select">
                            <select ng-model="search.periode" ng-change="getReleve()" ng-options="periode.libelle for periode in periodes.all">
                                <option value="" class="header-opt">[[translate('viescolaire.utils.periode')]]</option>
                            </select>
                        </label>
                    </section>
                </div>

            </div>
        </microbox>
        <div class="ten cell twelve-mobile">
            <article class="ten card twelve-mobile centered ng-scope" ng-if="evaluations.devoirs.all.length === 0">
                <i18n>evaluation.list.empty</i18n>
            </article>
            <div class="marginFive card" ng-if="evaluations.devoirs.all.length !== 0">
                <header class="headerStyle">
                    <h2 class="twelve-mobile"><i18n>evaluations.test.owner.list</i18n></h2>
                    <input type="text" ng-model="search.name" placeholder="[[translate('evaluations.filter.name')]]..." style="width: 99%;font-size: 1em;font-style: italic;">
                </header>
                <container template="evaluations" class="twelve cell toggle-buttons-spacer"></container>
            </div>
        </div>

    </div>
</div>
<section class="toggle-buttons" ng-class="{ hide: selected.devoirs.list.length == 0 }">
    <div class="toggle">
        <div class="row">
            <button ng-show="selected.devoirs.list.length === 1" class="cell ng-scope"
                    ng-click="goTo('/devoir/' + selected.devoirs.list[0].id + '/edit')">
                <i18n><span class="no-style">evaluations.test.edit</span></i18n>
            </button>
            <!-- TODO DUPLIQUER -->
            <button class="cell ng-scope" ng-click="confirmSuppretion()">
                <i18n><span class="no-style">evaluations.test.delete</span></i18n>
            </button>
        </div>
    </div>
</section>

<lightbox ng-if="selected.devoirs.list.length > 0 " show="opened.evaluation.suppretionMsg1" on-close="opened.evaluation.suppretionMsg1=false">
    <p><i18n>evaluations.devoir.information.suppression</i18n></p>
    <div ng-if="(selected.devoirs.list.length < 15)">
        <p><i18n>evaluations.devoir.recaputilatif</i18n>:</p>
        <ul>
            <li ng-repeat="devoir in selected.devoirs.list">[[devoir.name]]</li>
        </ul>
    </div>
    <p><i18n>evaluations.devoir.confirmation.question</i18n></p>
    <button class="marginFive" ng-click="firstConfirmationSuppDevoir()">
        <i18n>evaluations.devoir.confirmation</i18n>
    </button>
    <button class="marginFive" ng-click="annulerSuppretion()">
        <i18n>evaluations.devoir.annuler</i18n>
    </button>
</lightbox>

<lightbox ng-if="selected.devoirs.listwithEvaluatedMarks.length>0 || selected.devoirs.listwithEvaluatedSkills.length>0" show="opened.evaluation.suppretionMsg2" on-close="opened.evaluation.suppretionMsg2=false">
    <p ng-if="conditionAffichageText(1)" >[[textSuppretionMsg2.Text1]]</p>
    <p ng-if="conditionAffichageText(2)" >[[textSuppretionMsg2.Text2]]</p>
    <p ng-if="conditionAffichageText(3)" >[[textSuppretionMsg2.Text3]]</p>
    <div ng-if="conditionAffichageText(4)">
        <p  >[[textSuppretionMsg2.Text4]]</p>
        <div >
            <p><i18n>evaluations.devoir.recaputilatif.EvaluatedSkills</i18n>:</p>
            <ul>
                <li ng-repeat="devoir in selected.devoirs.listwithEvaluatedSkills">[[devoir.name]]</li>
            </ul>
        </div>
    </div>
    <div ng-if="conditionAffichageText(5)">
        <p  >[[textSuppretionMsg2.Text5]]</p>
        <div >
            <p><i18n>evaluations.devoir.recaputilatif.EvaluatedMarks</i18n>:</p>
            <ul>
                <li ng-repeat="devoir in selected.devoirs.listwithEvaluatedMarks">[[devoir.name]]</li>
            </ul>
        </div>
    </div>
    <div  ng-if="conditionAffichageText(6)" >
        <p  >[[textSuppretionMsg2.Text6]]</p>
        <div >
            <p><i18n>evaluations.devoir.recaputilatif.EvaluatedSkills</i18n>:</p>
            <ul>
                <li ng-repeat="devoir in selected.devoirs.listwithEvaluatedSkills">[[devoir.name]]</li>
            </ul>
        </div>
        <div >
            <p><i18n>evaluations.devoir.recaputilatif.EvaluatedMarks</i18n>:</p>
            <ul>
                <li ng-repeat="devoir in selected.devoirs.listwithEvaluatedMarks">[[devoir.name]]</li>
            </ul>
        </div>
    </div>
    <p>[[textSuppretionMsg2.TextFin]]</p>
    <button class="marginFive" ng-click="deleteDevoir()">
        <i18n>evaluations.devoir.confirmation</i18n>
    </button>
    <button class="marginFive" ng-click="annulerSuppretion()">
        <i18n>evaluations.devoir.annuler</i18n>
    </button>
</lightbox>